<<<<<<< HEAD
import { OuterSubscriber } from '../OuterSubscriber';
import { subscribeToResult } from '../util/subscribeToResult';
=======
import { SimpleOuterSubscriber, innerSubscribe, SimpleInnerSubscriber } from '../innerSubscribe';
>>>>>>> 6f5fd4790114a9d761d96ca3fbe8e8e19e12c4a4
export function debounce(durationSelector) {
    return (source) => source.lift(new DebounceOperator(durationSelector));
}
class DebounceOperator {
    constructor(durationSelector) {
        this.durationSelector = durationSelector;
    }
    call(subscriber, source) {
        return source.subscribe(new DebounceSubscriber(subscriber, this.durationSelector));
    }
}
<<<<<<< HEAD
class DebounceSubscriber extends OuterSubscriber {
=======
class DebounceSubscriber extends SimpleOuterSubscriber {
>>>>>>> 6f5fd4790114a9d761d96ca3fbe8e8e19e12c4a4
    constructor(destination, durationSelector) {
        super(destination);
        this.durationSelector = durationSelector;
        this.hasValue = false;
<<<<<<< HEAD
        this.durationSubscription = null;
=======
>>>>>>> 6f5fd4790114a9d761d96ca3fbe8e8e19e12c4a4
    }
    _next(value) {
        try {
            const result = this.durationSelector.call(this, value);
            if (result) {
                this._tryNext(value, result);
            }
        }
        catch (err) {
            this.destination.error(err);
        }
    }
    _complete() {
        this.emitValue();
        this.destination.complete();
    }
    _tryNext(value, duration) {
        let subscription = this.durationSubscription;
        this.value = value;
        this.hasValue = true;
        if (subscription) {
            subscription.unsubscribe();
            this.remove(subscription);
        }
<<<<<<< HEAD
        subscription = subscribeToResult(this, duration);
=======
        subscription = innerSubscribe(duration, new SimpleInnerSubscriber(this));
>>>>>>> 6f5fd4790114a9d761d96ca3fbe8e8e19e12c4a4
        if (subscription && !subscription.closed) {
            this.add(this.durationSubscription = subscription);
        }
    }
<<<<<<< HEAD
    notifyNext(outerValue, innerValue, outerIndex, innerIndex, innerSub) {
=======
    notifyNext() {
>>>>>>> 6f5fd4790114a9d761d96ca3fbe8e8e19e12c4a4
        this.emitValue();
    }
    notifyComplete() {
        this.emitValue();
    }
    emitValue() {
        if (this.hasValue) {
            const value = this.value;
            const subscription = this.durationSubscription;
            if (subscription) {
<<<<<<< HEAD
                this.durationSubscription = null;
                subscription.unsubscribe();
                this.remove(subscription);
            }
            this.value = null;
=======
                this.durationSubscription = undefined;
                subscription.unsubscribe();
                this.remove(subscription);
            }
            this.value = undefined;
>>>>>>> 6f5fd4790114a9d761d96ca3fbe8e8e19e12c4a4
            this.hasValue = false;
            super._next(value);
        }
    }
}
//# sourceMappingURL=debounce.js.map